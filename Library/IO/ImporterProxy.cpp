#include "ImporterProxy.hpp"
#include "OBJImporter.hpp"

namespace st::io
{

void ImporterProxy::readFile(const std::filesystem::path& pathToObjFile)
{

  if (pathToObjFile.extension() == ".obj") 
  {
    m_objImporter.readFromFile(pathToObjFile);
  }
}

std::vector<geometry::Vertex> ImporterProxy::getVertices()
{

  const std::vector<geometry::Vertex> cube_mock = {
        { { -0.5f, -0.5f, 0.5f }, { 0.375F, 1.0F - 0.00F }, { 1.0f, 0.0f, 0.0f }, { 0.0f, 0.0f, 1.0F } },
        { {  0.5f, -0.5f, 0.5f }, { 0.625F, 1.0F - 0.00F }, { 1.0f, 0.0f, 0.0f }, { 0.0f, 0.0f, 1.0F } },
        { {  0.5f,  0.5f, 0.5f }, { 0.625F, 1.0F - 0.25F }, { 1.0f, 0.0f, 0.0f }, { 0.0f, 0.0f, 1.0F } },
        { { -0.5f,  0.5f, 0.5f }, { 0.375F, 1.0F - 0.25F }, { 1.0f, 0.0f, 0.0f }, { 0.0f, 0.0f, 1.0F } },
        
        //Top 4-7
        { { -0.5f, 0.5f,  0.5f }, { 0.375F, 1.0F - 0.25F }, { 0.0f, 1.0f, 0.0f }, { 0.0f, 1.0f, 1.0F } },
        { {  0.5f, 0.5f,  0.5f }, { 0.625F, 1.0F - 0.25F }, { 0.0f, 1.0f, 0.0f }, { 0.0f, 1.0f, 1.0F } },
        { { -0.5f, 0.5f, -0.5f }, { 0.375F, 1.0F - 0.50F }, { 0.0f, 1.0f, 0.0f }, { 0.0f, 1.0f, 1.0F } },
        { {  0.5f, 0.5f, -0.5f }, { 0.625F, 1.0F - 0.50F }, { 0.0f, 1.0f, 0.0f }, { 0.0f, 1.0f, 1.0F } },

        //Back 8-11
        { { -0.5f,  0.5f, -0.5f }, { 0.375F, 1.0F - 0.50F }, { 0.0f, 0.0f, 1.0f }, { 0.0f, 0.0f, -1.0F } },
        { {  0.5f,  0.5f, -0.5f }, { 0.625F, 1.0F - 0.50F }, { 0.0f, 0.0f, 1.0f }, { 0.0f, 0.0f, -1.0F } },
        { {  0.5f, -0.5f, -0.5f }, { 0.625F, 1.0F - 0.75F }, { 0.0f, 0.0f, 1.0f }, { 0.0f, 0.0f, -1.0F } },
        { { -0.5f, -0.5f, -0.5f }, { 0.375F, 1.0F - 0.75F }, { 0.0f, 0.0f, 1.0f }, { 0.0f, 0.0f, -1.0F } },

        //Bottom 12-15
        { { -0.5f, -0.5f, -0.5f }, { 0.375F, 1.0F - 0.75F }, { 0.0f, 1.0f, 1.0f }, { 0.0f, -1.0f, 1.0F } },
        { {  0.5f, -0.5f, -0.5f }, { 0.625F, 1.0F - 0.75F }, { 0.0f, 1.0f, 1.0f }, { 0.0f, -1.0f, 1.0F } },
        { {  0.5f, -0.5f,  0.5f }, { 0.625F, 1.0F - 1.00F }, { 0.0f, 1.0f, 1.0f }, { 0.0f, -1.0f, 1.0F } },
        { { -0.5f, -0.5f,  0.5f }, { 0.375F, 1.0F - 1.00F }, { 0.0f, 1.0f, 1.0f }, { 0.0f, -1.0f, 1.0F } },

        // Right 16-19
        { { 0.5f, -0.5f,  0.5f }, { 0.625F, 1.0F - 0.00F }, { 1.0f, 0.0f, 1.0f }, { 1.0f, 0.0f, 0.0F } },
        { { 0.5f, -0.5f, -0.5f }, { 0.875F, 1.0F - 0.00F }, { 1.0f, 0.0f, 1.0f }, { 1.0f, 0.0f, 0.0F } },
        { { 0.5f,  0.5f, -0.5f }, { 0.875F, 1.0F - 0.25F }, { 1.0f, 0.0f, 1.0f }, { 1.0f, 0.0f, 0.0F } },
        { { 0.5f,  0.5f,  0.5f }, { 0.625F, 1.0F - 0.25F }, { 1.0f, 0.0f, 1.0f }, { 1.0f, 0.0f, 0.0F } },

        // Left 20-23
        { { -0.5f, -0.5f, -0.5f }, { 0.125F, 1.0F - 0.00F }, { 1.0f, 1.0f, 0.0f }, { 0.0f, -1.0f, 0.0F } },
        { { -0.5f, -0.5f,  0.5f }, { 0.375F, 1.0F - 0.00F }, { 1.0f, 1.0f, 0.0f }, { 0.0f, -1.0f, 0.0F } },
        { { -0.5f,  0.5f,  0.5f }, { 0.375F, 1.0F - 0.25F }, { 1.0f, 1.0f, 0.0f }, { 0.0f, -1.0f, 0.0F } },
        { { -0.5f,  0.5f, -0.5f }, { 0.125F, 1.0F - 0.25F }, { 1.0f, 1.0f, 0.0f }, { 0.0f, -1.0f, 0.0F } },
  };


  const std::vector<geometry::Vertex> cube_mock2 = {   { { -0.5, -0.5, 0.5 }, { 0.375, 1.0F - 0 }, { 1, 0, 0 }, { 0, 0, 1 }},
                                                       { { 0.5, -0.5, 0.5 }, { 0.625, 1.0F - 0 }, { 1, 0, 0 }, { 0, 0, 1 }},
                                                       { { 0.5, 0.5, 0.5 }, { 0.625, 1.0F - 0.25 }, { 1, 0, 0 }, { 0, 0, 1 }},
                                                       { { -0.5, 0.5, 0.5 }, { 0.375, 1.0F - 0.25 }, { 1, 0, 0 }, { 0, 0, 1 }},
                                                       { { -0.5, 0.5, 0.5 }, { 0.375, 1.0F - 0.25 }, { 1, 0, 0 }, { 0, 1, 0 }},
                                                       { { 0.5, 0.5, 0.5 }, { 0.625, 1.0F - 0.25 }, { 1, 0, 0 }, { 0, 1, 0 }},
                                                       { { 0.5, 0.5, -0.5 }, { 0.625, 1.0F - 0.5 }, { 1, 0, 0 }, { 0, 1, 0 }},
                                                       { { -0.5, 0.5, -0.5 }, { 0.375, 1.0F - 0.5 }, { 1, 0, 0 }, { 0, 1, 0 }},
                                                       { { -0.5, 0.5, -0.5 }, { 0.375, 1.0F - 0.5 }, { 1, 0, 0 }, { 0, 0, -1 }},
                                                       { { 0.5, 0.5, -0.5 }, { 0.625, 1.0F - 0.5 }, { 1, 0, 0 }, { 0, 0, -1 }},
                                                       { { 0.5, -0.5, -0.5 }, { 0.625, 1.0F - 0.75 }, { 1, 0, 0 }, { 0, 0, -1 }},
                                                       { { -0.5, -0.5, -0.5 }, { 0.375, 1.0F - 0.75 }, { 1, 0, 0 }, { 0, 0, -1 }},
                                                       { { -0.5, -0.5, -0.5 }, { 0.375, 1.0F - 0.75 }, { 1, 0, 0 }, { 0, -1, 0 }},
                                                       { { 0.5, -0.5, -0.5 }, { 0.625, 1.0F - 0.75 }, { 1, 0, 0 }, { 0, -1, 0 }},
                                                       { { 0.5, -0.5, 0.5 }, { 0.625, 1.0F - 1 }, { 1, 0, 0 }, { 0, -1, 0 }},
                                                       { { -0.5, -0.5, 0.5 }, { 0.375, 1.0F - 1 }, { 1, 0, 0 }, { 0, -1, 0 }},
                                                       { { 0.5, -0.5, 0.5 }, { 0.625, 1.0F - 0 }, { 1, 0, 0 }, { 1, 0, 0 }},
                                                       { { 0.5, -0.5, -0.5 }, { 0.875, 1.0F - 0 }, { 1, 0, 0 }, { 1, 0, 0 }},
                                                       { { 0.5, 0.5, -0.5 }, { 0.875, 1.0F - 0.25 }, { 1, 0, 0 }, { 1, 0, 0 }},
                                                       { { 0.5, 0.5, 0.5 }, { 0.625, 1.0F - 0.25 }, { 1, 0, 0 }, { 1, 0, 0 }},
                                                       { { -0.5, -0.5, -0.5 }, { 0.125, 1.0F - 0 }, { 1, 0, 0 }, { -1, 0, 0 }},
                                                       { { -0.5, -0.5, 0.5 }, { 0.375, 1.0F - 0 }, { 1, 0, 0 }, { -1, 0, 0 }},
                                                       { { -0.5, 0.5, 0.5 }, { 0.375, 1.0F - 0.25 }, { 1, 0, 0 }, { -1, 0, 0 }},
                                                       { { -0.5, 0.5, -0.5 }, { 0.125, 1.0F - 0.25 }, { 1, 0, 0 }, { -1, 0, 0 }} };




  const auto readedGeometry = m_objImporter.getGeometry();

  std::vector<geometry::Vertex> output;

  for (const auto& vertex : readedGeometry)
  {
      geometry::Vertex outputVertex {
                                    { vertex.pos.x, vertex.pos.y, vertex.pos.z },
                                    { vertex.textureCord.u, 1.0F - vertex.textureCord.v },
                                    { vertex.color.x, vertex.color.y, vertex.color.z },
                                    { vertex.normal.x, vertex.normal.y, vertex.normal.z }};

      output.emplace_back(outputVertex);

  }


  return output;
}

std::vector<geometry::Indices> ImporterProxy::getIndices()
{
    const auto indices = m_objImporter.getIndicesVector();

    const std::vector<uint32_t> cube_mock =
    {
        0, 1, 2, 0, 2, 3,
        4, 5, 6, 5, 7, 6,
        8, 9, 10, 10, 11, 8,
        12, 13, 14, 14, 15, 12,
        16, 17, 18, 18, 19, 16,
        20, 21, 22, 22, 23, 20,
    };

    const std::vector<uint32_t> cube_mock2 =
    {
        0, 1, 2, 0, 2, 3,
        4, 5, 6, 4, 6, 7,
        8, 9, 10, 8, 10, 11,
        12, 13, 14, 12, 14, 15,
        16, 17, 18, 16, 18, 19,
        20, 21, 22, 20, 22, 23
    };

    //Convert Indices to internal format

    return indices;
}


}
